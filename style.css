/* ===== –ë–∞–∑–æ–≤–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞ ===== */
body {
  display: flex;
  justify-content: center;
  margin: 0;
  padding: 20px;
  border: 1px solid red;
  --tile-size: 32px;          /* —Ä–∞–∑–º–µ—Ä —Ç–∞–π–ª–∞ */
  --frame: 64px;              /* —Ä–∞–∑–º–µ—Ä –∫–∞–¥—Ä–∞ –Ω–∞ –ª–∏—Å—Ç–µ */
  --cols: 6;
  --rows: 4;
  --trim: 16px; 
}

.field {
  display: grid;
  grid-template-columns: repeat(40, var(--tile-size));
  grid-template-rows: repeat(24, var(--tile-size));
  border: 3px solid #2917ed;
  margin-top: 20px;
}

/* ===== –¢–∞–π–ª—ã ===== */
.tile {
  position: relative;
  width: var(--tile-size);
  height: var(--tile-size);
  box-sizing: border-box;
  contain: paint;             /* –Ω–µ –ø—Ä–æ–≤–æ—Ü–∏—Ä—É–µ–º repaint –≤–æ–∫—Ä—É–≥ */
  will-change: contents;
  background-repeat: no-repeat;
}

/* –§–æ–Ω/–æ—Ç–ª–∞–¥–∫–∞ —Ç–∏–ø–æ–≤ —Ç–∞–π–ª–æ–≤ */
.tile.floor {
  background-color: #4d5f95;
  box-shadow:
    inset 2px 2px 3px rgba(0, 0, 0, 0.2),
    -2px -2px 5px rgba(187, 190, 236, 0.2),
    inset 2px 2px 5px rgba(0, 0, 0, 0.2);
}

.tile.wall {
  background-color: #555;
  box-shadow:
    -2px -2px 3px rgba(5, 36, 9, 0.259),
    inset 2px 2px 5px rgba(132, 146, 132, 0.2),
    -2px -2px 8px rgba(5, 36, 9, 0.259);
}

/* ===== –°—É—â–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–º–µ—Ç—ã (—Å–ª–æ–∏) ===== */
.creature,
.item {
  position: absolute;
  pointer-events: none;       /* –º–µ–Ω—å—à–µ hit-testing */
  backface-visibility: hidden;
  transform: translateZ(0);
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 25;                /* –Ω–∞–¥ —Ñ–æ–Ω–æ–º —Ç–∞–π–ª–∞ */
}

/* –ü—Ä–µ–¥–º–µ—Ç—ã (—ç–º–æ–¥–∑–∏) */
.health::before { content: '‚ù§Ô∏è'; }
.sword::before  { content: '‚öîÔ∏è'; }
.enemy::before  { content: 'üíÄ'; }

/* –ò–≥—Ä–æ–∫ ‚Äî —ç–º–æ–¥–∑–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª —Å–ø—Ä–∞–π—Ç */
.player::before { content: none !important; }

/* –°–ª–æ–π –∏–≥—Ä–æ–∫–∞ —á—É—Ç—å –≤—ã—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤ (–Ω–∞ —Å–ª—É—á–∞–π –Ω–∞–ª–æ–∂–µ–Ω–∏–π) */
.creature.player { z-index: 26; }

/* ===== HUD ===== */
.hud {
  position: fixed;
  top: 10px; left: 10px; right: 10px;
  max-width: 220px;
  padding: 10px 12px;
  background: rgba(20, 20, 30, 0.65);
  color: #fff;
  font: 14px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  border-radius: 10px;
  backdrop-filter: blur(6px);
  z-index: 9999;
}
.hud-row { display: grid; grid-template-columns: 36px 1fr auto; gap: 8px; align-items: center; margin-top: 6px; }
.hud-row:first-child { margin-top: 0; }
.hud-label { opacity: 0.85; }
.hud-bar { height: 10px; background: #333; border-radius: 6px; overflow: hidden; }
.hud-fill { height: 100%; width: 100%; background: #00ff04; }
.hud.hud--dead { opacity: 0.75; filter: grayscale(0.2); }

/* ===== –ü–æ–ª–æ—Å–∫–∏ HP –Ω–∞–¥ —Å—É—â–µ—Å—Ç–≤–∞–º–∏ ===== */
.hpbar {
  position: absolute;
  left: 2px; right: 2px;
  top: 2px; height: 5px;
  background: rgba(0,0,0,0.35);
  border-radius: 4px;
  overflow: hidden;
  z-index: 30;
  pointer-events: none;
}
.hpbar-fill {
  height: 100%;
  width: 100%;
  background: #3bd16f;        /* –∑–µ–ª—ë–Ω—ã–π */
  transition: width 120ms linear;
}
.tile.wall .hpbar { display: none; }                          /* –Ω–∞ —Å—Ç–µ–Ω–∞—Ö –Ω–µ—á–µ–≥–æ —Ä–∏—Å–æ–≤–∞—Ç—å */
.creature.enemy ~ .hpbar .hpbar-fill { background: #ff7a57; } /* –≤—Ä–∞–≥–∏ ‚Äî –∫—Ä–∞—Å–Ω–æ-–∂—ë–ª—Ç—ã–π */
.tile .hpbar { display: none; }                               /* –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç–æ */
.tile .creature ~ .hpbar { display: block; }                  /* –µ—Å–ª–∏ –µ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤–æ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º */

/* ===== –ò–ì–†–û–ö: —Å–ø—Ä–∞–π—Ç 6 –∫–æ–ª–æ–Ω–æ–∫ √ó 4 —Å—Ç—Ä–æ–∫–∏ =====
   –§–∞–π–ª: /sprites/Swordsman_lvl3_Walk_with_shadow.png
   background-size: 600% 400% ‚Üí —à–∏—Ä–∏–Ω–∞ –≤—Å–µ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ = 6 —Ç–∞–π–ª–æ–≤, –≤—ã—Å–æ—Ç–∞ = 4 —Ç–∞–π–ª–∞.
   –û–¥–∏–Ω ¬´—à–∞–≥¬ª –ø–æ Y –º–µ–∂–¥—É —Ä—è–¥–∞–º–∏ = 100% / 3 (–∞ –Ω–µ 100%).
*/
.creature.player{
  background-image: url('Tilesets/With_shadow/Swordsman_lvl3_Walk_with_shadow.png'); /* –ø—Ä–æ–≤–µ—Ä—å –ø—É—Ç—å */
  background-repeat: no-repeat;
  background-size: 600% 400%;
  /* image-rendering: pixelated; */
    
  /* –ú–∞—Å—à—Ç–∞–± –≥–µ—Ä–æ—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–π–ª–∞. 1 ‚Äî —Ä–æ–≤–Ω–æ –≤ —Ç–∞–π–ª, 1.5‚Äì2 ‚Äî –ø–æ–∫—Ä—É–ø–Ω–µ–µ */
  /* transform: translateZ(0) scale(var(--hero-scale, 1));
  transform-origin: bottom center; */

  /* –ù–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ: –ø–µ—Ä–≤—ã–π –∫–∞–¥—Ä, –ø–µ—Ä–≤—ã–π —Ä—è–¥ */
  /* background-position: -32px -16px; */
}.creature.player {
  position: relative;   /* —á—Ç–æ–±—ã ::after –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å */
  background: none;     /* –Ω–µ —Ä–∏—Å—É–µ–º —Ñ–æ–Ω –Ω–∞ —Å–∞–º–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ */
}

/* –°–ê–ú —Å–ø—Ä–∞–π—Ç */
.creature.player::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  /* —Ä–∏—Å—É–µ–º –∫–∞–¥—Ä –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ 64√ó64 */
  width: var(--frame);
  height: var(--frame);
  transform: translate(-50%, -50%);
  image-rendering: pixelated;

  /* —Ç–≤–æ–π –ª–∏—Å—Ç 384√ó256 = 6√ó4 –ø–æ 64px */
  background-image: url('Tilesets/With_shadow/Swordsman_lvl3_Walk_with_shadow.png');
  background-repeat: no-repeat;
  background-size: calc(var(--cols) * var(--frame)) calc(var(--rows) * var(--frame));
  background-position: 0 0; /* –ø–µ—Ä–≤—ã–π –∫–∞–¥—Ä, –ø–µ—Ä–≤—ã–π —Ä—è–¥ */

  /* –æ—Ç—Ä–µ–∑–∞–µ–º –ø–æ–ª—è –ø–æ 16px ‚Üí –≤–∏–¥–∏–º—ã–µ 32√ó32 –ø–æ —Ü–µ–Ω—Ç—Ä—É */
  clip-path: inset(var(--trim));
}

/* –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –¥–≤–∏–≥–∞–µ–º –ü–û –†–Ø–î–ê–ú –Ω–∞ –∫—Ä–∞—Ç–Ω—ã–µ 64px */
.player.dir-down::after  { background-position-y:    0px; }
.player.dir-left::after  { background-position-y:  -64px; }
.player.dir-right::after { background-position-y: -128px; }
.player.dir-up::after    { background-position-y: -192px; }

/* –•–æ–¥—å–±–∞: 6 –∫–∞–¥—Ä–æ–≤ –ø–æ X (0 ‚Üí -320) */
/* @keyframes walk-6 {
  from { background-position-x:   0px; }
  to   { background-position-x: -320px; }
}
.player.walking::after { animation: walk-6 var(--walk-duration, 320ms) steps(6) infinite; } */

/* –°—Ç–æ–∏–º ‚Äî –ø–µ—Ä–≤—ã–π –∫–∞–¥—Ä –ø–æ X */
.creature.player:not(.walking)::after { background-position-x: 0px; }
